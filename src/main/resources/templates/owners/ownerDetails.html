<!DOCTYPE html>

<html xmlns:th="https://www.thymeleaf.org" th:replace="~{fragments/layout :: layout (~{::body}, 'owners')}">

	<body>
		<!-- 見出し文 -->
		<h2>Owner Information</h2>
		<!-- 登録/更新処理正常終了時、正常メッセージ出力 -->
		<div th:if="${message}" class="alert alert-success" id="success-message">
			<!-- 正常メッセージ -->
			<span th:text="${message}"></span>
		</div>
		<!-- 登録/更新処理異常終了時、異常メッセージ出力 -->
		<div th:if="${error}" class="alert alert-danger" id="error-message">
			<!-- 異常メッセージ -->
			<span th:text="${error}"></span>
		</div>
		
		<!-- テーブル全体定義 -->
		<table class="table table-striped" th:object="${owner}">
			<!-- テーブル内の行定義 -->
			<tr>
				<!-- オーナー名カラム -->
				<th>Name</th>
				<!-- オーナー名のデータセル定義 -->
				<td><b th:text="*{firstName + ' ' + lastName}"></b></td>
			</tr>
			<!-- テーブル内の行定義 -->
			<tr>
				<!-- 住所カラム -->
				<th>Address</th>
				<!-- 住所のデータセル定義 -->
				<td th:text="*{address}"></td>
			</tr>
			<!-- テーブル内の行定義 -->
			<tr>
				<!-- 都市名カラム -->
				<th>City</th>
				<!-- 都市名のデータセル定義 -->
				<td th:text="*{city}"></td>
			</tr>
			<!-- テーブル内の行定義 -->
			<tr>
				<!-- 電話番号カラム -->
				<th>Telephone</th>
				<!-- 電話番号のデータセル定義 -->
				<td th:text="*{telephone}"></td>
			</tr>
		</table>
		<!-- オーナー情報更新画面遷移ボタン -->
		<a th:href="@{__${owner.id}__/edit}" class="btn btn-primary">Edit Owner</a>
		<!-- ペット情報登録画面遷移ボタン -->
		<a th:href="@{__${owner.id}__/pets/new}" class="btn btn-primary">Add New Pet</a>
		<!-- 改行 -->
		<br />
		<br />
		<br />
		<!-- 見出し文 -->
		<h2>Pets and Visits</h2>
		<!-- テーブル全体定義 -->
		<table class="table table-striped">
			<!-- テーブル内の行定義 -->
			<tr th:each="pet : ${owner.pets}">
				<!-- データセル定義 -->
				<td valign="top">
					<!-- 用語リスト定義 (dtやddとセットで使用する) -->
					<dl class="dl-horizontal">
						<!-- オーナー名見出し -->
						<dt>Name</dt>
						<!-- オーナー名 -->
						<dd th:text="${pet.name}"></dd>
						<!-- オーナー名見出し -->
						<dt>Birth Date</dt>
						<!-- オーナー名 -->
						<dd th:text="${#temporals.format(pet.birthDate, 'yyyy-MM-dd')}"></dd>
						<!-- 種族名見出し -->
						<dt>Type</dt>
						<!-- 種族名 -->
						<dd th:text="${pet.type}"></dd>
					</dl>
				</td>
				<!-- データセル定義 -->
				<td valign="top">
					<!-- テーブル全体定義 -->
					<table class="table-condensed">
						<!-- テーブルカラム名定義 -->
						<thead>
							<!-- テーブル内の行定義 -->
							<tr>
								<!-- 訪問日カラム -->
								<th>Visit Date</th>
								<!-- 内容カラム -->
								<th>Description</th>
							</tr>
						</thead>
						<!-- テーブル内の行定義 -->
						<tr th:each="visit : ${pet.visits}">
							<!-- 訪問日のデータセル定義 -->
							<td th:text="${#temporals.format(visit.date, 'yyyy-MM-dd')}"></td>
							<!-- 内容のデータセル定義 -->
							<td th:text="${visit?.description}"></td>
						</tr>
						<!-- テーブル内の行定義 -->
						<tr>
							<!-- ペット情報編集画面遷移リンク -->
							<td><a th:href="@{__${owner.id}__/pets/__${pet.id}__/edit}">Edit Pet</a></td>
							<!-- 訪問情報追加画面遷移リンク -->
							<td><a th:href="@{__${owner.id}__/pets/__${pet.id}__/visits/new}">Add Visit</a></td>
						</tr>
					</table>
				</td>
			</tr>
			
		</table>
		<!-- JavaScript記述 -->
		<script>
			// 3秒後に成功/エラーメッセージを隠す関数
			function hideMessages() {
				setTimeout(function() {
					document.getElementById("success-message").style.display = "none";
					document.getElementById("error-message").style.display = "none";
				}, 3000);
			}
			
			// 関数の呼び出し
			hideMessages();
		</script>
	</body>
</html>
			